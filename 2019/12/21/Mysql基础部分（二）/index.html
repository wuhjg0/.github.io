<!DOCTYPE html>
<html lang="en">
    <!-- title -->




<!-- keywords -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="John Doe">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="John Doe">
    
    <meta name="keywords" content="hexo,hexo-theme,hexo-blog">
    
    <meta name="description" content="">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>Mysql基础部分（二） · WuHJg&#39;s Blog.</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= "/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= "/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >WuHJg&#39;s Blog.</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">Mysql基础部分（二）</a>
            </div>
    </div>
    
    <a class="home-link" href=/>WuHJg's Blog.</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            Mysql基础部分（二）
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">12.7k</span>Reading time: <span class="post-count reading-time">53 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2019/12/21</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h2 id="MYSQL基础部分（二）"><a href="#MYSQL基础部分（二）" class="headerlink" title="MYSQL基础部分（二）"></a>MYSQL基础部分（二）</h2><h3 id="MySQL-where-子句"><a href="#MySQL-where-子句" class="headerlink" title="MySQL where 子句"></a>MySQL where 子句</h3><p>MySQL where 子句</p>
<p>我们知道从MySQL表中使用SQL SELECT 语句来读取数据。</p>
<p>如需有条件地从表中选取数据，可将 WHERE 子句添加到 SELECT 语句中。</p>
<p>语法</p>
<p>以下是SQL SELECT 语句使用 WHERE 子句从数据表中读取数据的通用语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT field1, field2,...fieldN FROM table_name1, table_name2...</span><br><span class="line">[WHERE condition1 [AND [OR]] condition2.....</span><br></pre></td></tr></table></figure>

<p>查询语句中你可以使用一个或者多个表，表之间使用逗号(,)分割，并使用WHERE语句来设定查询条件。<br>可以在WHERE子句中指定任何条件。<br>可以使用AND或者OR指定一个或多个条件。<br>WHERE子句也可以运用于SQL的 DELETE 或者 UPDATE 命令。<br>WHERE 子句类似于程序语言中的if条件，根据 MySQL 表中的字段值来读取指定的数据。<br>以下为操作符列表，可用于 WHERE 子句中。</p>
<p>下表中实例假定 A为10 B为20</p>
<table>
<thead>
<tr>
<th align="right">操作符</th>
<th align="right">描述</th>
<th align="right">实例</th>
</tr>
</thead>
<tbody><tr>
<td align="right">=</td>
<td align="right">等号，检测两个值是否相等，如果相等返回true</td>
<td align="right">(A = B) 返回false。</td>
</tr>
<tr>
<td align="right">&lt;&gt;</td>
<td align="right">或 !=    不等于，检测两个值是否相等，如果不相等返回true</td>
<td align="right">(A != B) 返回 true。</td>
</tr>
<tr>
<td align="right">&gt;</td>
<td align="right">大于号，检测左边的值是否大于右边的值, 如果左边的值大于右边的值返回true</td>
<td align="right">(A &gt; B) 返回false。</td>
</tr>
<tr>
<td align="right">&lt;</td>
<td align="right">小于号，检测左边的值是否小于右边的值, 如果左边的值小于右边的值返回true</td>
<td align="right">(A &lt; B) 返回 true。</td>
</tr>
<tr>
<td align="right">&gt;=</td>
<td align="right">大于等于号，检测左边的值是否大于或等于右边的值, 如果左边的值大于或等于右边的值返回true</td>
<td align="right">(A &gt;= B) 返回false。</td>
</tr>
<tr>
<td align="right">&lt;=</td>
<td align="right">小于等于号，检测左边的值是否小于于或等于右边的值, 如果左边的值小于或等于右边的值返回true</td>
<td align="right">(A &lt;= B) 返回 true。</td>
</tr>
<tr>
<td align="right">如果我们想再MySQL数据表中读取指定的数据，WHERE 子句是非常有用的。</td>
<td align="right"></td>
<td align="right"></td>
</tr>
</tbody></table>
<p>使用主键来作为 WHERE 子句的条件查询是非常快速的。</p>
<p>如果给定的条件在表中没有任何匹配的记录，那么查询不会返回任何数据。</p>
<h4 id="从命令提示符中读取数据"><a href="#从命令提示符中读取数据" class="headerlink" title="从命令提示符中读取数据"></a>从命令提示符中读取数据</h4><p>我们将在SQL SELECT语句使用WHERE子句来读取MySQL数据表 w3cschool_tbl 中的数据：</p>
<p>实例</p>
<p>以下实例将读取 w3cschool_tbl 表中 w3cschool_author 字段值为 Sanjay 的所有记录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; SELECT  from w3cschool_tbl WHERE w3cschool_author=&apos;Sanjay&apos;;</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">| w3cschool_id | w3cschool_title | w3cschool_author | submission_date |</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">|           3 | JAVA Tutorial  | Sanjay          | 2007-05-21      |</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">1 rows in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p>除非你使用 LIKE 来比较字符串，否则MySQL的WHERE子句的字符串比较是不区分大小写的。 你可以使用 BINARY 关键字来设定WHERE子句的字符串比较是区分大小写的。</p>
<p>如下实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; SELECT  from w3cschool_tbl \</span><br><span class="line">          WHERE BINARY w3cschool_author=&apos;sanjay&apos;;</span><br><span class="line">Empty set (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p><strong>使用PHP脚本读取数据</strong><br>你可以使用PHP函数的mysql_query()及相同的SQL SELECT 带上 WHERE 子句的命令来获取数据。</p>
<p>该函数用于执行SQL命令，然后通过 PHP 函数 mysql_fetch_array() 来输出所有查询的数据。</p>
<p>实例<br>以下实例将从 w3cschool_tbl 表中返回使用 w3cschool_author 字段值为 Sanjay 的记录：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$dbhost = <span class="string">'localhost:3036'</span>;</span><br><span class="line">$dbuser = <span class="string">'root'</span>;</span><br><span class="line">$dbpass = <span class="string">'rootpassword'</span>;</span><br><span class="line">$conn = mysql_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line"><span class="keyword">if</span>(! $conn )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">$sql = <span class="string">'SELECT w3cschool_id, w3cschool_title,</span></span><br><span class="line"><span class="string">               w3cschool_author, submission_date</span></span><br><span class="line"><span class="string">        FROM w3cschool_tbl</span></span><br><span class="line"><span class="string">        WHERE w3cschool_author="Sanjay"'</span>;</span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="string">'W3CSCHOOL'</span>);</span><br><span class="line">$retval = mysql_query( $sql, $conn );</span><br><span class="line"><span class="keyword">if</span>(! $retval )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not get data: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>($row = mysql_fetch_array($retval, MYSQL_ASSOC))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Tutorial ID :&#123;$row['w3cschool_id']&#125;</span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"Title: &#123;$row['w3cschool_title']&#125; </span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"Author: &#123;$row['w3cschool_author']&#125; </span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"Submission Date : &#123;$row['submission_date']&#125; </span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"--------------------------------</span></span><br><span class="line"><span class="string">"</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Fetched data successfully\n"</span>;</span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="MySQL-UPDATE-查询"><a href="#MySQL-UPDATE-查询" class="headerlink" title="MySQL UPDATE 查询"></a>MySQL UPDATE 查询</h3><p>如果我们需要修改或更新MySQL中的数据，我们可以使用 SQL UPDATE 命令来操作。.</p>
<p>语法<br>以下是 UPDATE 命令修改 MySQL 数据表数据的通用SQL语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE table_name SET field1=new-value1, field2=new-value2</span><br><span class="line">[WHERE Clause]</span><br></pre></td></tr></table></figure>

<p><strong>你可以同时更新一个或多个字段。<br>你可以在 WHERE 子句中指定任何条件。<br>你可以在一个单独表中同时更新数据。<br>当你需要更新数据表中指定行的数据时 WHERE 子句是非常有用的。</strong></p>
<p>通过命令提示符更新数据<br>以下我们将在 SQL UPDATE 命令使用 WHERE子句来更新w3cschool_tbl表中指定的数据：</p>
<p>实例<br>以下实例将更新数据表中 w3cschool_id 为 3 的 w3cschool_title 字段值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:*******</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; UPDATE w3cschool_tbl </span><br><span class="line">    -&gt; SET w3cschool_title=&apos;Learning JAVA&apos; </span><br><span class="line">    -&gt; WHERE w3cschool_id=3;</span><br><span class="line">Query OK, 1 row affected (0.04 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>


<p><strong>使用PHP脚本更新数据</strong></p>
<p>PHP中使用函数mysql_query()来执行SQL语句，你可以在SQL UPDATE语句中使用或者不使用WHERE子句。</p>
<p>该函数与在mysql&gt;命令提示符中执行SQL语句的效果是一样的。</p>
<p>实例<br>以下实例将更新 w3cschool_id 为3的 w3cschool_title 字段的数据。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$dbhost = <span class="string">'localhost:3036'</span>;</span><br><span class="line">$dbuser = <span class="string">'root'</span>;</span><br><span class="line">$dbpass = <span class="string">'rootpassword'</span>;</span><br><span class="line">$conn = mysql_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line"><span class="keyword">if</span>(! $conn )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</span><br><span class="line">&#125; </span><br><span class="line">$sql = <span class="string">'UPDATE w3cschool_tbl</span></span><br><span class="line"><span class="string">        SET w3cschool_title="Learning JAVA"</span></span><br><span class="line"><span class="string">        WHERE w3cschool_id=3'</span>;</span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="string">'W3CSCHOOL'</span>);</span><br><span class="line">$retval = mysql_query( $sql, $conn );</span><br><span class="line"><span class="keyword">if</span>(! $retval )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not update data: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Updated data successfully\n"</span>;</span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="MySQL-DELETE-语句"><a href="#MySQL-DELETE-语句" class="headerlink" title="MySQL DELETE 语句"></a>MySQL DELETE 语句</h3><p>MySQL DELETE 语句</p>
<p>你可以使用 SQL 的 DELETE FROM 命令来删除 MySQL 数据表中的记录。</p>
<p>你可以在mysql&gt;命令提示符或PHP脚本中执行该命令。</p>
<p>语法<br>以下是SQL DELETE 语句从MySQL数据表中删除数据的通用语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM table_name [WHERE Clause]</span><br></pre></td></tr></table></figure>

<p><strong>如果没有指定 WHERE 子句，MySQL表中的所有记录将被删除。<br>你可以在 WHERE 子句中指定任何条件<br>您可以在单个表中一次性删除记录。<br>当你想删除数据表中指定的记录时 WHERE 子句是非常有用的。</strong></p>
<p>从命令行中删除数据<br>这里我们将在 SQL DELETE 命令中使用 WHERE 子句来删除MySQL数据表w3cschool_tbl所选的数据。</p>
<p>实例<br>以下实例将删除 w3cschool_tbl 表中 w3cschool_id 为3 的记录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:*******</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; DELETE FROM w3cschool_tbl WHERE w3cschool_id=3;</span><br><span class="line">Query OK, 1 row affected (0.23 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p><strong>使用 PHP 脚本删除数据</strong></p>
<p>PHP使用 mysql_query() 函数来执行SQL语句， 你可以在SQL DELETE命令中使用或不使用 WHERE 子句。</p>
<p>该函数与 mysql&gt;命令符执行SQL命令的效果是一样的。</p>
<p>实例<br>以下PHP实例将删除w3cschool_tbl表中w3cschool_id为3的记录:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$dbhost = <span class="string">'localhost:3036'</span>;</span><br><span class="line">$dbuser = <span class="string">'root'</span>;</span><br><span class="line">$dbpass = <span class="string">'rootpassword'</span>;</span><br><span class="line">$conn = mysql_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line"><span class="keyword">if</span>(! $conn )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">$sql = <span class="string">'DELETE FROM w3cschool_tbl</span></span><br><span class="line"><span class="string">        WHERE w3cschool_id=3'</span>;</span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="string">'W3CSCHOOL'</span>);</span><br><span class="line">$retval = mysql_query( $sql, $conn );</span><br><span class="line"><span class="keyword">if</span>(! $retval )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not delete data: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Deleted data successfully\n"</span>;</span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="MySQL-LIKE-子句"><a href="#MySQL-LIKE-子句" class="headerlink" title="MySQL LIKE 子句"></a>MySQL LIKE 子句</h3><p>MySQL LIKE 子句</p>
<p>我们知道在MySQL中使用 SQL SELECT 命令来读取数据， 同时我们可以在 SELECT 语句中使用 WHERE 子句来获取指定的记录。</p>
<p>WHERE 子句中可以使用等号 (=) 来设定获取数据的条件，如 “w3cschool_author = ‘Sanjay’”。</p>
<p>但是有时候我们需要获取 w3cschool_author 字段含有 “jay” 字符的所有记录，这时我们就需要在 WHERE 子句中使用 SQL LIKE 子句。</p>
<p>SQL LIKE 子句中使用百分号(%)字符来表示任意字符，类似于UNIX或正则表达式中的星号 (*)。</p>
<p>如果没有使用百分号(%), LIKE 子句与等号（=）的效果是一样的。</p>
<p>语法<br>以下是SQL SELECT 语句使用 LIKE 子句从数据表中读取数据的通用语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT field1, field2,...fieldN </span><br><span class="line">FROM table_name1, table_name2...</span><br><span class="line">WHERE field1 LIKE condition1 [AND [OR]] filed2 = &apos;somevalue&apos;</span><br></pre></td></tr></table></figure>
<p><strong>你可以在WHERE子句中指定任何条件。<br>你可以在WHERE子句中使用LIKE子句。<br>你可以使用LIKE子句代替等号(=)。<br>LIKE 通常与 % 一同使用，类似于一个元字符的搜索。<br>你可以使用AND或者OR指定一个或多个条件。<br>你可以在 DELETE 或 UPDATE 命令中使用 WHERE…LIKE 子句来指定条件。</strong></p>
<p><strong>在命令提示符中使用 LIKE 子句</strong></p>
<p>以下我们将在 SQL SELECT 命令中使用 WHERE…LIKE 子句来从MySQL数据表 w3cschool_tbl 中读取数据。</p>
<p>实例<br>以下是我们将w3cschool_tbl表中获取w3cschool_author字段中以”jay”为结尾的的所有记录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:*******</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; SELECT * from w3cschool_tbl </span><br><span class="line">    -&gt; WHERE w3cschool_author LIKE &apos;%jay&apos;;</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">| w3cschool_id | w3cschool_title | w3cschool_author | submission_date |</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">|           3 | JAVA Tutorial  | Sanjay          | 2007-05-21      |</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">1 rows in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p><strong>在PHP脚本中使用 LIKE 子句</strong><br>你可以使用PHP函数的mysql_query()及相同的SQL SELECT 带上 WHERE…LIKE 子句的命令来获取数据。</p>
<p>该函数用于执行SQL命令，然后通过 PHP 函数 mysql_fetch_array() 来输出所有查询的数据。</p>
<p>但是如果是DELETE或者UPDATE中使用 WHERE…LIKE 子句的SQL语句，则无需使用mysql_fetch_array() 函数。</p>
<p>实例<br>以下是我们使用PHP脚本在w3cschool_tbl表中读取w3cschool_author字段中以”jay”为结尾的的所有记录：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$dbhost = <span class="string">'localhost:3036'</span>;</span><br><span class="line">$dbuser = <span class="string">'root'</span>;</span><br><span class="line">$dbpass = <span class="string">'rootpassword'</span>;</span><br><span class="line">$conn = mysql_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line"><span class="keyword">if</span>(! $conn )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">$sql = <span class="string">'SELECT w3cschool_id, w3cschool_title,</span></span><br><span class="line"><span class="string">               w3cschool_author, submission_date</span></span><br><span class="line"><span class="string">        FROM w3cschool_tbl</span></span><br><span class="line"><span class="string">        WHERE w3cschool_author LIKE "%jay%"'</span>;</span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="string">'W3CSCHOOL'</span>);</span><br><span class="line">$retval = mysql_query( $sql, $conn );</span><br><span class="line"><span class="keyword">if</span>(! $retval )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not get data: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>($row = mysql_fetch_array($retval, MYSQL_ASSOC))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Tutorial ID :&#123;$row['w3cschool_id']&#125;  &lt;br&gt; "</span>.</span><br><span class="line">         <span class="string">"Title: &#123;$row['w3cschool_title']&#125; &lt;br&gt; "</span>.</span><br><span class="line">         <span class="string">"Author: &#123;$row['w3cschool_author']&#125; &lt;br&gt; "</span>.</span><br><span class="line">         <span class="string">"Submission Date : &#123;$row['submission_date']&#125; &lt;br&gt; "</span>.</span><br><span class="line">         <span class="string">"--------------------------------&lt;br&gt;"</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Fetched data successfully\n"</span>;</span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="MySQL-排序"><a href="#MySQL-排序" class="headerlink" title="MySQL 排序"></a>MySQL 排序</h3><p>我们知道从MySQL表中使用SQL SELECT 语句来读取数据。</p>
<p>如果我们需要对读取的数据进行排序，我们就可以使用MySQL的 ORDER BY 子句来设定你想按哪个字段哪中方式来进行排序，再返回搜索结果。</p>
<p>本章节使用的数据库结构及数据下载：MySQL.sql</p>
<p>语法<br>以下是SQL SELECT 语句使用 ORDER BY 子句将查询数据排序后再返回数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT field1, field2,...fieldN FROM table_name1, table_name2...</span><br><span class="line">ORDER BY field1, [field2...] [ASC [DESC]]</span><br></pre></td></tr></table></figure>
<p><strong>你可以使用任何字段来作为排序的条件，从而返回排序后的查询结果。<br>你可以设定多个字段来排序。<br>你可以使用 ASC 或 DESC 关键字来设置查询结果是按升序或降序排列。 默认情况下，它是按升排列。<br>你可以添加 WHERE…LIKE 子句来设置条件。</strong><br><br><br><strong>在命令提示符中使用 ORDER BY 子句</strong><br>以下将在 SQL SELECT 语句中使用 ORDER BY 子句来读取MySQL 数据表 w3cschool_tbl 中的数据：</p>
<p>实例<br>尝试以下实例，结果将按升序排列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; SELECT  from w3cschool_tbl ORDER BY w3cschool_author ASC;</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">| w3cschool_id | w3cschool_title | w3cschool_author | submission_date |</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">|           2 | Learn MySQL    | Abdul S         | 2007-05-24      |</span><br><span class="line">|           1 | Learn PHP      | John Poul       | 2007-05-24      |</span><br><span class="line">|           3 | JAVA Tutorial  | Sanjay          | 2007-05-06      |</span><br><span class="line">+-------------+----------------+-----------------+-----------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * from w3cschool_tbl ORDER BY w3cschool_author DESC;</span><br><span class="line">+-----------+------------------+-----------------+-----------------+</span><br><span class="line">| w3cschool_id | w3cschool_title | w3cschool_author | submission_date |</span><br><span class="line">+-----------+------------------+-----------------+-----------------+</span><br><span class="line">|         3 | JAVA Tutorial    | Sanjay          | 2007-05-06      |</span><br><span class="line">|         1 | Learn PHP        | John Poul       | 2007-05-24      |</span><br><span class="line">|         2 | Learn MySQL      | Abdul S         | 2007-05-24      |</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p>读取 w3cschool_tbl 表中所有数据并按 w3cschool_author 字段的降序排列。</p>
<p><strong>在PHP脚本中使用 ORDER BY 子句</strong></p>
<p>你可以使用PHP函数的mysql_query()及相同的SQL SELECT 带上 ORDER BY 子句的命令来获取数据。 该函数用于执行SQL命令，然后通过 PHP 函数 mysql_fetch_array() 来输出所有查询的数据。<br>实例<br>尝试以下实例，查询后的数据按 w3cschool_author 字段的降序排列后返回。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$dbhost = <span class="string">'localhost:3036'</span>;</span><br><span class="line">$dbuser = <span class="string">'root'</span>;</span><br><span class="line">$dbpass = <span class="string">'rootpassword'</span>;</span><br><span class="line">$conn = mysql_connect($dbhost, $dbuser, $dbpass);</span><br><span class="line"><span class="keyword">if</span>(! $conn )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">$sql = <span class="string">'SELECT w3cschool_id, w3cschool_title,</span></span><br><span class="line"><span class="string">               w3cschool_author, submission_date</span></span><br><span class="line"><span class="string">        FROM w3cschool_tbl</span></span><br><span class="line"><span class="string">        ORDER BY  w3cschool_author DESC'</span>;</span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="string">'W3CSCHOOL'</span>);</span><br><span class="line">$retval = mysql_query( $sql, $conn );</span><br><span class="line"><span class="keyword">if</span>(! $retval )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">'Could not get data: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>($row = mysql_fetch_array($retval, MYSQL_ASSOC))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Tutorial ID :&#123;$row['w3cschool_id']&#125;</span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"Title: &#123;$row['w3cschool_title']&#125; </span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"Author: &#123;$row['w3cschool_author']&#125; </span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"Submission Date : &#123;$row['submission_date']&#125; </span></span><br><span class="line"><span class="string"> "</span>.</span><br><span class="line">         <span class="string">"--------------------------------</span></span><br><span class="line"><span class="string">"</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Fetched data successfully\n"</span>;</span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="MySQL-分组"><a href="#MySQL-分组" class="headerlink" title="MySQL 分组"></a>MySQL 分组</h3><h4 id="MySQL-GROUP-BY-语句"><a href="#MySQL-GROUP-BY-语句" class="headerlink" title="MySQL GROUP BY 语句"></a>MySQL GROUP BY 语句</h4><p>GROUP BY 语句根据一个或多个列对结果集进行分组。</p>
<p>在分组的列上我们可以使用 COUNT, SUM, AVG,等函数。</p>
<p><strong>GROUP BY 语法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name, function(column_name)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column_name operator value</span><br><span class="line">GROUP BY column_name;</span><br></pre></td></tr></table></figure>

<p>实例演示<br>本章节实例使用到了以下表结构及数据，使用前我们可以先将以下数据导入数据库中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SET NAMES utf8;</span><br><span class="line">SET FOREIGN_KEY_CHECKS = 0;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">--  Table structure for `employee_tbl`</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `employee_tbl`;</span><br><span class="line">CREATE TABLE `employee_tbl` (</span><br><span class="line">  `id` int(11) NOT NULL,</span><br><span class="line">  `name` char(10) NOT NULL DEFAULT &apos;&apos;,</span><br><span class="line">  `date` datetime NOT NULL,</span><br><span class="line">  `singin` tinyint(4) NOT NULL DEFAULT &apos;0&apos; COMMENT &apos;登录次数&apos;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">--  Records of `employee_tbl`</span><br><span class="line">-- ----------------------------</span><br><span class="line">BEGIN;</span><br><span class="line">INSERT INTO `employee_tbl` VALUES (&apos;1&apos;, &apos;小明&apos;, &apos;2016-04-22 15:25:33&apos;, &apos;1&apos;), (&apos;2&apos;, &apos;小王&apos;, &apos;2016-04-20 15:25:47&apos;, &apos;3&apos;), (&apos;3&apos;, &apos;小丽&apos;, &apos;2016-04-19 15:26:02&apos;, &apos;2&apos;), (&apos;4&apos;, &apos;小王&apos;, &apos;2016-04-07 15:26:14&apos;, &apos;4&apos;), (&apos;5&apos;, &apos;小明&apos;, &apos;2016-04-11 15:26:40&apos;, &apos;4&apos;), (&apos;6&apos;, &apos;小明&apos;, &apos;2016-04-04 15:26:54&apos;, &apos;2&apos;);</span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line">SET FOREIGN_KEY_CHECKS = 1;</span><br></pre></td></tr></table></figure>
<p>导入成功后，执行以下 SQL 语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set names utf8;</span><br><span class="line">mysql&gt; SELECT * FROM employee_tbl;</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">| id | name   | date                | singin |</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">|  1 | 小明 | 2016-04-22 15:25:33 |      1 |</span><br><span class="line">|  2 | 小王 | 2016-04-20 15:25:47 |      3 |</span><br><span class="line">|  3 | 小丽 | 2016-04-19 15:26:02 |      2 |</span><br><span class="line">|  4 | 小王 | 2016-04-07 15:26:14 |      4 |</span><br><span class="line">|  5 | 小明 | 2016-04-11 15:26:40 |      4 |</span><br><span class="line">|  6 | 小明 | 2016-04-04 15:26:54 |      2 |</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br><span class="line">接下来我们使用 GROUP BY 语句 将数据表按名字进行分组，并统计每个人有多少条记录：</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT name, COUNT(*) FROM   employee_tbl GROUP BY name;</span><br><span class="line">+--------+----------+</span><br><span class="line">| name   | COUNT(*) |</span><br><span class="line">+--------+----------+</span><br><span class="line">| 小丽 |        1 |</span><br><span class="line">| 小明 |        3 |</span><br><span class="line">| 小王 |        2 |</span><br><span class="line">+--------+----------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>
<p><strong>使用 WITH ROLLUP</strong></p>
<p>WITH ROLLUP 可以实现在分组统计数据基础上再进行相同的统计（SUM,AVG,COUNT…）。</p>
<p>例如我们将以上的数据表按名字进行分组，再统计每个人登录的次数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT name, SUM(singin) as singin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;</span><br><span class="line">+--------+--------------+</span><br><span class="line">| name   | singin_count |</span><br><span class="line">+--------+--------------+</span><br><span class="line">| 小丽 |            2 |</span><br><span class="line">| 小明 |            7 |</span><br><span class="line">| 小王 |            7 |</span><br><span class="line">| NULL   |           16 |</span><br><span class="line">+--------+--------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>其中记录 NULL 表示所有人的登录次数。</p>
<p>我们可以使用 coalesce 来设置一个可以取代 NUll 的名称，coalesce 语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select coalesce(a,b,c);</span><br></pre></td></tr></table></figure>
<p>参数说明：如果a==null,则选择b；如果b==null,则选择c；如果a!=null,则选择a；如果a b c 都为null ，则返回为null（没意义）。</p>
<p>以下实例中如果名字为空我们使用总数代替：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT coalesce(name, &apos;总数&apos;), SUM(singin) as singin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">| coalesce(name, &apos;总数&apos;) | singin_count |</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">| 小丽                   |            2 |</span><br><span class="line">| 小明                   |            7 |</span><br><span class="line">| 小王                   |            7 |</span><br><span class="line">| 总数                   |           16 |</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">4 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-NULL值处理"><a href="#MySQL-NULL值处理" class="headerlink" title="MySQL NULL值处理"></a>MySQL NULL值处理</h3><p>我们已经知道MySQL使用SQL SELECT命令及WHERE子句来读取数据表中的数据，但是当提供的查询条件变量为NULL时，该命令可能就无法正常工作。</p>
<p>为了处理这种情况，MySQL提供了三大运算符：</p>
<p><strong>IS NULL：当列的值是NULL，此运算符返回true。</strong><br><strong>IS NOT NULL：当列的值不为NULL，运算符返回true。</strong><br><strong>&lt;=&gt;：  比较操作符（变量=运算符），当比较器的两个变量NULL时返回true。</strong></p>
<p>您不能使用= NULL或！= NULL在列中查找NULL值。</p>
<p>在MySQL中，NULL值与任何其他值的比较（即使是NULL）永远返回false，即NULL = NULL返回false。</p>
<p>MySQL中处理NULL使用IS NULL和IS NOT NULL运算符。</p>
<p>在命令官方中使用NULL值</p>
<p>以下实例中假设数据库W3CSCHOOL中的表tcount_tbl包含两列w3cschool_author和w3cschool_count，w3cschool_count中设置插入空值。</p>
<p>实例<br>尝试以下实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root @ host＃mysql -u root -p密码;</span><br><span class="line">输入密码：*******</span><br><span class="line">mysql&gt;使用W3CSCHOOL;</span><br><span class="line">数据库已更改</span><br><span class="line">mysql&gt;创建表tcount_tbl</span><br><span class="line">    -&gt;（</span><br><span class="line">    -&gt; w3cschool_author varchar（40）NOT NULL，</span><br><span class="line">    -&gt; w3cschool_count INT</span><br><span class="line">    -&gt;）;</span><br><span class="line">查询正常，受影响的0行（0.05秒）</span><br><span class="line">mysql&gt;插入到tcount_tbl</span><br><span class="line">    -&gt;（w3cschool_author，w3cschool_count）值（&apos;mahran&apos;，20）;</span><br><span class="line">mysql&gt;插入到tcount_tbl</span><br><span class="line">    -&gt;（w3cschool_author，w3cschool_count）值（&apos;mahnaz&apos;，NULL）;</span><br><span class="line">mysql&gt;插入到tcount_tbl</span><br><span class="line">    -&gt;（w3cschool_author，w3cschool_count）值（&apos;Jen&apos;，NULL）;</span><br><span class="line">mysql&gt;插入到tcount_tbl</span><br><span class="line">    -&gt;（w3cschool_author，w3cschool_count）值（&apos;Gill&apos;，20）;</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * from tcount_tbl;</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">| w3cschool_author | w3cschool_count |</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">| mahran | 20 |</span><br><span class="line">| mahnaz | NULL |</span><br><span class="line">| 仁| NULL |</span><br><span class="line">| ill 20 |</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">设置4行（0.00秒）</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p>以下实例中你可以看到=和！=运算符是不起作用的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM tcount_tbl在哪里w3cschool_count = NULL;</span><br><span class="line">空置（0.00秒）</span><br><span class="line">mysql&gt; SELECT * FROM tcount_tbl在哪里w3cschool_count！= NULL;</span><br><span class="line">空置（0.01秒）</span><br><span class="line">发现数据表中w3cschool_count列是否为NULL，必须使用IS NULL和IS NOT NULL，如下实例：</span><br><span class="line"></span><br><span class="line">MySQL的&gt;选择*从tcount_tbl </span><br><span class="line">    -&gt; W3CSchool_Count是NULL;</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">| w3cschool_author | w3cschool_count |</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">| mahnaz | NULL |</span><br><span class="line">| 仁| NULL |</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">设置2行（0.00秒）</span><br><span class="line">mysql&gt; SELECT *从tcount_tbl </span><br><span class="line">    -&gt;在哪里w3cschool_count不为空；</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">| w3cschool_author | w3cschool_count |</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">| mahran | 20 |</span><br><span class="line">| ill 20 |</span><br><span class="line">+ ----------------- + ---------------- +</span><br><span class="line">设置2行（0.00秒）</span><br></pre></td></tr></table></figure>

<p><strong>使用PHP脚本处理NULL值</strong></p>
<p>PHP脚本中你可以在if … else语句来处理变量是否为空，并生成相应的条件语句。</p>
<p>以下实例中PHP设置了$ w3cschool_count变量，然后使用该变量与数据表中的w3cschool_count转换进行比较：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">&lt;？php</span><br><span class="line">$ dbhost =<span class="string">'本地主机：3036'</span>;</span><br><span class="line">$ dbuser =<span class="string">'root'</span>;</span><br><span class="line">$ dbpass =<span class="string">'rootpassword'</span>;</span><br><span class="line">$ conn = mysql_connect（$ dbhost，$ dbuser，$ dbpass）;</span><br><span class="line">如果（！$ conn）</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>（<span class="string">'无法连接：'</span>。mysql_error（））;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>（<span class="keyword">isset</span>（$ w3cschool_count））</span><br><span class="line">&#123;</span><br><span class="line">   $ sql =<span class="string">'SELECT w3cschool_author，w3cschool_count</span></span><br><span class="line"><span class="string">           来自tcount_tbl</span></span><br><span class="line"><span class="string">           W3cschool_count = $ w3cschool_count'</span>;</span><br><span class="line">&#125;</span><br><span class="line">其他</span><br><span class="line">&#123;</span><br><span class="line">   $ sql =<span class="string">'SELECT w3cschool_author，w3cschool_count</span></span><br><span class="line"><span class="string">           来自tcount_tbl</span></span><br><span class="line"><span class="string">           w3cschool_count是$ w3cschool_count'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysql_select_db（<span class="string">'W3CSCHOOL'</span>）;</span><br><span class="line">$ retval = mysql_query（$ sql，$ conn）;</span><br><span class="line">如果（！$ retval）</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">die</span>（<span class="string">'无法获取数据：'</span>。mysql_error（））;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>（$ row = mysql_fetch_array（$ retval，MYSQL_ASSOC））</span><br><span class="line">&#123;</span><br><span class="line">    回显“作者：&#123;$ row [<span class="string">'w3cschool_author'</span>]&#125; &lt;br&gt;。</span><br><span class="line">         “计数：&#123;$ row [<span class="string">'w3cschool_count'</span>]&#125; &lt;br&gt;。</span><br><span class="line">         “ -------------------------------- &lt;br&gt;”;</span><br><span class="line">&#125; </span><br><span class="line">回显“已成功获取数据\ n”；</span><br><span class="line">mysql_close（$ conn）;</span><br><span class="line">？&gt;</span><br><span class="line">``````  </span><br><span class="line"></span><br><span class="line"><span class="comment">### MySQL 正则表达式</span></span><br><span class="line"></span><br><span class="line">在前面的章节我们已经了解到MySQL可以通过 **LIKE ...%** 来进行模糊匹配。</span><br><span class="line"></span><br><span class="line">MySQL 同样也支持其他正则表达式的匹配， MySQL中使用 REGEXP 操作符来进行正则表达式匹配。</span><br><span class="line"></span><br><span class="line">如果您了解PHP或Perl，那么操作起来就非常简单，因为MySQL的正则表达式匹配与这些脚本的类似。</span><br><span class="line"></span><br><span class="line">下表中的正则模式可应用于 REGEXP 操作符中。</span><br><span class="line"></span><br><span class="line">模式  |	描述</span><br><span class="line">--:|--:|</span><br><span class="line">^|	匹配输入字符串的开始位置。如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 <span class="string">'\n'</span> 或 <span class="string">'\r'</span> 之后的位置。</span><br><span class="line">$	|匹配输入字符串的结束位置。如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 <span class="string">'\n'</span> 或 <span class="string">'\r'</span> 之前的位置。</span><br><span class="line">.	|匹配除 <span class="string">"\n"</span> 之外的任何单个字符。要匹配包括 <span class="string">'\n'</span> 在内的任何字符，请使用象 <span class="string">'[.\n]'</span> 的模式。</span><br><span class="line">[...]|	字符集合。匹配所包含的任意一个字符。例如， <span class="string">'[abc]'</span> 可以匹配 <span class="string">"plain"</span> 中的 <span class="string">'a'</span>。</span><br><span class="line">[^...]|	负值字符集合。匹配未包含的任意字符。例如， <span class="string">'[^abc]'</span> 可以匹配 <span class="string">"plain"</span> 中的<span class="string">'p'</span>。</span><br><span class="line">p1|p2|p3|	匹配 p1 或 p2 或 p3。例如，<span class="string">'z|food'</span> 能匹配 <span class="string">"z"</span> 或 <span class="string">"food"</span>。<span class="string">'(z|f)ood'</span> 则匹配 <span class="string">"zood"</span> 或 <span class="string">"food"</span>。</span><br><span class="line">&amp;nbsp;  |匹配前面的子表达式零次或多次。例如，zo 能匹配 <span class="string">"z"</span> 以及 <span class="string">"zoo"</span>。* 等价于&#123;<span class="number">0</span>,&#125;。</span><br><span class="line">+|	匹配前面的子表达式一次或多次。例如，<span class="string">'zo+'</span> 能匹配 <span class="string">"zo"</span> 以及 <span class="string">"zoo"</span>，但不能匹配 <span class="string">"z"</span>。+ 等价于 &#123;<span class="number">1</span>,&#125;。</span><br><span class="line">&#123;n&#125;	|n 是一个非负整数。匹配确定的 n 次。例如，<span class="string">'o&#123;2&#125;'</span> 不能匹配 <span class="string">"Bob"</span> 中的 <span class="string">'o'</span>，但是能匹配 <span class="string">"food"</span> 中的两个 o。</span><br><span class="line">&#123;n,m&#125;|	m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"></span><br><span class="line">了解以上的正则需求后，我们就可以根据自己的需求来编写带有正则表达式的SQL语句。以下我们将列出几个小实例(表名：person_tbl )来加深我们的理解：</span><br><span class="line"></span><br><span class="line">查找name字段中以<span class="string">'st'</span>为开头的所有数据：</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP <span class="string">'^st'</span>;</span><br><span class="line">``</span><br><span class="line">查找name字段中以<span class="string">'ok'</span>为结尾的所有数据：</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP <span class="string">'ok$'</span>;</span><br><span class="line">``</span><br><span class="line">查找name字段中包含<span class="string">'mar'</span>字符串的所有数据：</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP <span class="string">'mar'</span>;</span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">查找name字段中以元音字符开头或以<span class="string">'ok'</span>字符串结尾的所有数据：</span><br><span class="line"></span><br><span class="line">``</span><br><span class="line">mysql&gt; SELECT name FROM person_tbl WHERE name REGEXP <span class="string">'^[aeiou]|ok$'</span>;</span><br><span class="line">``</span><br><span class="line"></span><br><span class="line"><span class="comment">### MySQL 事务</span></span><br><span class="line"></span><br><span class="line">MySQL 事务主要用于处理操作量大，复杂度高的数据。比如说，在人员管理系统中，你删除一个人员，你即需要删除人员的基本资料，也要删除和该人员相关的信息，如信箱，文章等等，这样，这些数据库操作语句就构成一个事务！</span><br><span class="line"></span><br><span class="line">**在MySQL中只有使用了Innodb数据库引擎的数据库或表才支持事务</span><br><span class="line">事务处理可以用来维护数据库的完整性，保证成批的SQL语句要么全部执行，要么全部不执行</span><br><span class="line">事务用来管理insert,update,delete语句**</span><br><span class="line"></span><br><span class="line">一般来说，事务是必须满足<span class="number">4</span>个条件（ACID）： Atomicity（原子性）、Consistency（稳定性）、Isolation（隔离性）、Durability（可靠性）</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、事务的原子性：一组事务，要么成功；要么撤回。</span><br><span class="line"><span class="number">2</span>、稳定性 ： 有非法数据（外键约束之类），事务撤回。</span><br><span class="line"><span class="number">3</span>、隔离性：事务独立运行。一个事务处理后的结果，影响了其他事务，那么其他事务会撤回。事务的<span class="number">100</span>%隔离，需要牺牲速度。</span><br><span class="line"><span class="number">4</span>、可靠性：软、硬件崩溃后，InnoDB数据表驱动会利用日志文件重构修改。可靠性和高速度不可兼得， innodb_flush_log_at_trx_commit选项 决定什么时候把事务保存到日志里。</span><br><span class="line"></span><br><span class="line"><span class="comment">#### 在MySQL控制台使用事务来操作</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>，开始一个事务</span><br></pre></td></tr></table></figure>
<p>start transaction</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2, 做保存点</span><br></pre></td></tr></table></figure>
<p>savepoint 保存点名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">3, 操作</span><br><span class="line"></span><br><span class="line">4，可以回滚，可以提交，没有问题，就提交，有问题就回滚。</span><br><span class="line"></span><br><span class="line">**PHP中使用事务实例**</span><br><span class="line">``````php</span><br><span class="line">&lt;?php</span><br><span class="line">$handler=mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;password&quot;);</span><br><span class="line">mysql_select_db(&quot;task&quot;);</span><br><span class="line">mysql_query(&quot;SET AUTOCOMMIT=0&quot;);//设置为不自动提交，因为MYSQL默认立即执行 mysql_query(&quot;BEGIN&quot;);//开始事务定义</span><br><span class="line">if(!mysql_query(&quot;insert into trans (id) values(&apos;2&apos;)&quot;))</span><br><span class="line">&#123;</span><br><span class="line">mysql_query(&quot;ROOLBACK&quot;);//判断当执行失败时回滚</span><br><span class="line">&#125;</span><br><span class="line">if(!mysql_query(&quot;insert into trans (id) values(&apos;4&apos;)&quot;))</span><br><span class="line">&#123;</span><br><span class="line">mysql_query(&quot;ROOLBACK&quot;);//判断执行失败回滚</span><br><span class="line">&#125;</span><br><span class="line">mysql_query(&quot;COMMIT&quot;);//执行事务</span><br><span class="line">mysql_close($handler);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-ALTER命令"><a href="#MySQL-ALTER命令" class="headerlink" title="MySQL ALTER命令"></a>MySQL ALTER命令</h3><p>当我们需要修改数据表名或者修改数据表字段时，就需要使用到MySQL ALTER命令。</p>
<p>先创建一张表，表名为：testalter_tbl。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@host# mysql -u root -p password;</span><br><span class="line">Enter password:</span><br><span class="line">mysql&gt; use W3CSCHOOL;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table testalter_tbl</span><br><span class="line">    -&gt; (</span><br><span class="line">    -&gt; i INT,</span><br><span class="line">    -&gt; c CHAR(1)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.05 sec)</span><br><span class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| i     | int(11) | YES  |     | NULL    |       |</span><br><span class="line">| c     | char(1) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<br>

<p><strong>删除，添加或修改表字段</strong></p>
<p>如下命令使用了 ALTER 命令及 DROP 子句来删除以上创建表的 i 字段：</p>
<p><code>mysql&gt; ALTER TABLE testalter_tbl  DROP i;</code><br>如果数据表中只剩余一个字段则无法使用DROP来删除字段。</p>
<p>MySQL 中使用 ADD 子句来想数据表中添加列，如下实例在表 testalter_tbl 中添加 i 字段，并定义数据类型:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl ADD i INT;</span><br></pre></td></tr></table></figure>
<p>执行以上命令后，i 字段会自动添加到数据表字段的末尾。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| c     | char(1) | YES  |     | NULL    |       |</span><br><span class="line">| i     | int(11) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<br>

<p>如果你需要指定新增字段的位置，可以使用MySQL提供的关键字 FIRST (设定位第一列)， AFTER 字段名（设定位于某个字段之后）。</p>
<p>尝试以下 ALTER TABLE 语句, 在执行成功后，使用 SHOW COLUMNS 查看表结构的变化：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE testalter_tbl DROP i;</span><br><span class="line">ALTER TABLE testalter_tbl ADD i INT FIRST;</span><br><span class="line">ALTER TABLE testalter_tbl DROP i;</span><br><span class="line">ALTER TABLE testalter_tbl ADD i INT AFTER c;</span><br></pre></td></tr></table></figure>

<p>FIRST 和 AFTER 关键字只占用于 ADD 子句，所以如果你想重置数据表字段的位置就需要先使用 DROP 删除字段然后使用 ADD 来添加字段并设置位置。</p>
<p><strong>修改字段类型及名称</strong></p>
<p>如果需要修改字段类型及名称, 你可以在ALTER命令中使用 MODIFY 或 CHANGE 子句 。</p>
<p>例如，把字段 c 的类型从 CHAR(1) 改为 CHAR(10)，可以执行以下命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl MODIFY c CHAR(10);</span><br></pre></td></tr></table></figure>
<p>使用 CHANGE 子句, 语法有很大的不同。 在 CHANGE 关键字之后，紧跟着的是你要修改的字段名，然后指定新字段的类型及名称。尝试如下实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl CHANGE i j BIGINT;</span><br></pre></td></tr></table></figure>

<p>如果你现在想把字段 j 从 BIGINT 修改为 INT，SQL语句如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl CHANGE j j INT;</span><br></pre></td></tr></table></figure>

<p><strong>ALTER TABLE 对 Null 值和默认值的影响</strong><br>当你修改字段时，你可以指定是否包含只或者是否设置默认值。</p>
<p>以下实例，指定字段 j 为 NOT NULL 且默认值为100 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl </span><br><span class="line">    -&gt; MODIFY j BIGINT NOT NULL DEFAULT 100;</span><br></pre></td></tr></table></figure>
<p>如果你不设置默认值，MySQL会自动设置该字段默认为 NULL。</p>
<p><strong>修改字段默认值</strong><br>你可以使用 ALTER 来修改字段的默认值，尝试以下实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000;</span><br><span class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| c     | char(1) | YES  |     | NULL    |       |</span><br><span class="line">| i     | int(11) | YES  |     | 1000    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>你也可以使用 ALTER 命令及 DROP子句来删除字段的默认值，如下实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl ALTER i DROP DEFAULT;</span><br><span class="line">mysql&gt; SHOW COLUMNS FROM testalter_tbl;</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| c     | char(1) | YES  |     | NULL    |       |</span><br><span class="line">| i     | int(11) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line">Changing a Table Type:</span><br></pre></td></tr></table></figure>
<br>

<p>修改数据表类型，可以使用 ALTER 命令及 TYPE 子句来完成。尝试以下实例，我们将表 testalter_tbl 的类型修改为 MYISAM ：</p>
<p>注意：查看数据表类型可以使用 SHOW TABLE STATUS 语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl TYPE = MYISAM;</span><br><span class="line">mysql&gt;  SHOW TABLE STATUS LIKE &apos;testalter_tbl&apos;\G</span><br><span class="line"> 1. row **</span><br><span class="line">           Name: testalter_tbl</span><br><span class="line">           Type: MyISAM</span><br><span class="line">     Row_format: Fixed</span><br><span class="line">           Rows: 0</span><br><span class="line"> Avg_row_length: 0</span><br><span class="line">    Data_length: 0</span><br><span class="line">Max_data_length: 25769803775</span><br><span class="line">   Index_length: 1024</span><br><span class="line">      Data_free: 0</span><br><span class="line"> Auto_increment: NULL</span><br><span class="line">    Create_time: 2007-06-03 08:04:36</span><br><span class="line">    Update_time: 2007-06-03 08:04:36</span><br><span class="line">     Check_time: NULL</span><br><span class="line"> Create_options:</span><br><span class="line">        Comment:</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>修改表名</strong><br>如果需要修改数据表的名称，可以在 ALTER TABLE 语句中使用 RENAME 子句来实现。</p>
<p>尝试以下实例将数据表 testalter_tbl 重命名为 alter_tbl：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl RENAME TO alter_tbl;</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-索引"><a href="#MySQL-索引" class="headerlink" title="MySQL 索引"></a>MySQL 索引</h3><p>MySQL索引的建立对于MySQL的高效运行是很重要的，索引可以大大提高MySQL的检索速度。<br>打个比方，如果合理的设计且使用索引的MySQL是一辆兰博基尼的话，那么没有设计和使用索引的MySQL就是一个人力三轮车。<br>拿汉语字典的目录页（索引）打比方，我们可以按拼音、笔画、偏旁部首等排序的目录（索引）快速查找到需要的字。<br>索引分单列索引和组合索引。单列索引，即一个索引只包含单个列，一个表可以有多个单列索引，但这不是组合索引。组合索引，即一个索引包含多个列。<br>创建索引时，你需要确保该索引是应用在 SQL 查询语句的条件(一般作为 WHERE 子句的条件)。<br>实际上，索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录。<br>上面都在说使用索引的好处，但过多的使用索引将会造成滥用。因此索引也会有它的缺点：虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件。</p>
<p>建立索引会占用磁盘空间的索引文件。</p>
<h4 id="普通索引"><a href="#普通索引" class="headerlink" title="普通索引"></a>普通索引</h4><p><strong>创建索引</strong></p>
<p>这是最基本的索引，它没有任何限制。它有以下几种创建方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX indexName ON mytable(username(length));</span><br></pre></td></tr></table></figure>
<p>如果是CHAR，VARCHAR类型，length可以小于字段实际长度；如果是BLOB和TEXT类型，必须指定 length。</p>
<p><strong>修改表结构(添加索引)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER table tableName ADD INDEX indexName(columnName)</span><br></pre></td></tr></table></figure>

<p><strong>创建表的时候直接指定</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE mytable(  </span><br><span class="line"> </span><br><span class="line">ID INT NOT NULL,   </span><br><span class="line"> </span><br><span class="line">username VARCHAR(16) NOT NULL,  </span><br><span class="line"> </span><br><span class="line">INDEX [indexName] (username(length))  </span><br><span class="line"> </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>删除索引的语法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX [indexName] ON mytable;</span><br></pre></td></tr></table></figure>

<h4 id="唯一索引"><a href="#唯一索引" class="headerlink" title="唯一索引"></a>唯一索引</h4><p>它与前面的普通索引类似，不同的就是：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值的组合必须唯一。它有以下几种创建方式：</p>
<p><strong>创建索引</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE UNIQUE INDEX indexName ON mytable(username(length))</span><br></pre></td></tr></table></figure>

<p><strong>修改表结构</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER table mytable ADD UNIQUE [indexName] (username(length))</span><br></pre></td></tr></table></figure>

<p><strong>创建表的时候直接指定</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE mytable(  </span><br><span class="line"> </span><br><span class="line">ID INT NOT NULL,   </span><br><span class="line"> </span><br><span class="line">username VARCHAR(16) NOT NULL,  </span><br><span class="line"> </span><br><span class="line">UNIQUE [indexName] (username(length))  </span><br><span class="line"> </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="使用ALTER-命令添加和删除索引"><a href="#使用ALTER-命令添加和删除索引" class="headerlink" title="使用ALTER 命令添加和删除索引"></a>使用ALTER 命令添加和删除索引</h4><p>有四种方式来添加数据表的索引：</p>
<ol>
<li>ALTER TABLE tbl_name ADD PRIMARY KEY (column_list): 该语句添加一个主键，这意味着索引值必须是唯一的，且不能为NULL。</li>
<li>ALTER TABLE tbl_name ADD UNIQUE index_name (column_list): 这条语句创建索引的值必须是唯一的（除了NULL外，NULL可能会出现多次）。</li>
<li>ALTER TABLE tbl_name ADD INDEX index_name (column_list): 添加普通索引，索引值可出现多次。</li>
<li>ALTER TABLE tbl_name ADD FULLTEXT index_name (column_list):该语句指定了索引为 FULLTEXT ，用于全文索引。</li>
</ol>
<p>以下实例为在表中添加索引。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl ADD INDEX (c);</span><br></pre></td></tr></table></figure>

<p>你还可以在 ALTER 命令中使用 DROP 子句来删除索引。尝试以下实例删除索引:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl DROP INDEX c;</span><br></pre></td></tr></table></figure>

<p>使用 ALTER 命令添加和删除主键<br>主键只能作用于一个列上，添加主键索引时，你需要确保该主键默认不为空（NOT NULL）。实例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl MODIFY i INT NOT NULL;</span><br><span class="line">mysql&gt; ALTER TABLE testalter_tbl ADD PRIMARY KEY (i);</span><br></pre></td></tr></table></figure>

<p>你也可以使用 ALTER 命令删除主键：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE testalter_tbl DROP PRIMARY KEY;</span><br></pre></td></tr></table></figure>

<p>删除主键时只需指定PRIMARY KEY，但在删除索引时，你必须知道索引名。</p>
<h4 id="显示索引信息"><a href="#显示索引信息" class="headerlink" title="显示索引信息"></a>显示索引信息</h4><p>你可以使用 SHOW INDEX 命令来列出表中的相关的索引信息。可以通过添加 \G 来格式化输出信息。</p>
<p>尝试以下实例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW INDEX FROM table_name; \G</span><br><span class="line">........</span><br></pre></td></tr></table></figure>

<h3 id="MySQL临时表"><a href="#MySQL临时表" class="headerlink" title="MySQL临时表"></a>MySQL临时表</h3><p>MySQL临时表在我们需要保存一些临时数据时是非常有用的。临时表只在当前连接可见，当关闭连接时，MySQL会自动删除表并释放所有空间。</p>
<p>临时表在MySQL 3.23版本中添加，如果你的MySQL版本低于3.23版本就无法使用MySQL的临时表。不过现在一般很少有再使用这么低版本的MySQL数据库服务了。</p>
<p>MySQL临时表只在当前连接可见，如果您使用PHP脚本来创建MySQL临时表，那每当PHP脚本执行完成后，该临时表也会自动销毁。</p>
<p>如果您使用了其他MySQL客户端程序连接MySQL数据库服务器来创建临时表，那么只有在关闭客户端程序时才会销毁临时表，当然你也可以手动销毁。</p>
<p>实例</p>
<p>以下展示了使用MySQL临时表的简单实例，以下的SQL代码可以适用于PHP脚本的mysql_query（）函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;创建临时表SalesSummary（</span><br><span class="line">    -&gt; product_name VARCHAR（50）非空</span><br><span class="line">    -&gt;，total_sales DECIMAL（12,2）NOT NULL默认0.00</span><br><span class="line">    -&gt;，avg_unit_price DECIMAL（7,2）NOT NULL默认0.00</span><br><span class="line">    -&gt;，total_units_sold INT UNSIGNED NOT NULL默认值0</span><br><span class="line">）;</span><br><span class="line">查询正常，受影响的0行（0.00秒）</span><br><span class="line"></span><br><span class="line">mysql&gt;插入SalesSummary</span><br><span class="line">    -&gt;（产品名称，总销售额，平均单位价格，已售单位）</span><br><span class="line">    -&gt;值</span><br><span class="line">    -&gt;（&apos;cucumber&apos;，100.25，90，2）;</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM SalesSummary;</span><br><span class="line">+ -------------- + ------------- + ---------------- + --- --------------- +</span><br><span class="line">| 产品名称| total_sales | avg_unit_price | total_units_sold |</span><br><span class="line">+ -------------- + ------------- + ---------------- + --- --------------- +</span><br><span class="line">| 黄瓜| 100.25 | 90.00 | 2 |</span><br><span class="line">+ -------------- + ------------- + ---------------- + --- --------------- +</span><br><span class="line">设置1行（0.00秒）</span><br></pre></td></tr></table></figure>

<p>当您使用<strong>SHOW TABLES</strong>命令显示数据表列表时，您将无法看到SalesSummary表。</p>
<p>如果您退出当前MySQL会话，再使用<strong>SELECT</strong>命令来重新读取原先创建的临时表数据，那你会发现数据库中没有该表的存在，因为在您退出时该临时表已经被销毁了。</p>
<h4 id="删除MySQL临时表"><a href="#删除MySQL临时表" class="headerlink" title="删除MySQL临时表"></a>删除MySQL临时表</h4><p>默认情况下，当您自己与数据库的连接后，临时表就会自动被销毁。当然你也可以在当前MySQL会话使用DROP TABLE命令来手动删除临时表。</p>
<p>以下是手动删除临时表的实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;创建临时表SalesSummary（</span><br><span class="line">    -&gt; product_name VARCHAR（50）非空</span><br><span class="line">    -&gt;，total_sales DECIMAL（12,2）NOT NULL默认0.00</span><br><span class="line">    -&gt;，avg_unit_price DECIMAL（7,2）NOT NULL默认0.00</span><br><span class="line">    -&gt;，total_units_sold INT UNSIGNED NOT NULL默认值0</span><br><span class="line">）;</span><br><span class="line">查询正常，受影响的0行（0.00秒）</span><br><span class="line"></span><br><span class="line">mysql&gt;插入SalesSummary</span><br><span class="line">    -&gt;（产品名称，总销售额，平均单位价格，已售单位）</span><br><span class="line">    -&gt;值</span><br><span class="line">    -&gt;（&apos;cucumber&apos;，100.25，90，2）;</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM SalesSummary;</span><br><span class="line">+ -------------- + ------------- + ---------------- + --- --------------- +</span><br><span class="line">| 产品名称| total_sales | avg_unit_price | total_units_sold |</span><br><span class="line">+ -------------- + ------------- + ---------------- + --- --------------- +</span><br><span class="line">| 黄瓜| 100.25 | 90.00 | 2 |</span><br><span class="line">+ -------------- + ------------- + ---------------- + --- --------------- +</span><br><span class="line">设置1行（0.00秒）</span><br><span class="line">mysql&gt; DROP TABLE SalesSummary;</span><br><span class="line">mysql&gt; SELECT * FROM SalesSummary;</span><br><span class="line">错误1146：表&apos;W3CSCHOOL.SalesSummary&apos;不存在</span><br><span class="line">`````` </span><br><span class="line"></span><br><span class="line">### MySQL复制表</span><br><span class="line"></span><br><span class="line">如果我们需要完全的复制MySQL的数据表，包括表的结构，索引，替换值等。如果仅使用CREATE TABLE ... SELECT命令，是无法实现的。</span><br><span class="line"></span><br><span class="line">复制MySQL数据表，步骤如下：</span><br><span class="line"></span><br><span class="line">1. 使用SHOW CREATE TABLE命令获取创建的数据表（CREATE TABLE）语句，该语句包含了原数据表的结构，索引等。</span><br><span class="line">2. 复制以下命令显示的SQL语句，修改数据表名，并执行SQL语句，通过以上命令将完全的复制数据表结构。</span><br><span class="line">3. 如果你想复制表的内容，你就可以使用INSERT INTO ... SELECT语句来实现。</span><br><span class="line"></span><br><span class="line">实例</span><br><span class="line"></span><br><span class="line">尝试以下实例来复制表w3cschool_tbl。</span><br><span class="line"></span><br><span class="line">步骤一：</span><br><span class="line"></span><br><span class="line">获取数据表的完整结构。</span><br></pre></td></tr></table></figure>
<p>mysql&gt;显示创建表w3cschool_tbl \ G;<br><strong><strong><strong><strong><strong><strong>***</strong></strong></strong></strong></strong></strong> 1.行<strong><strong><strong><strong>****</strong></strong></strong></strong> <strong>***</strong><br>       表：w3cschool_tbl<br>创建表：CREATE TABLE<code>w3cschool_tbl</code>（<br>  w3cschool_id int（11）非空auto_increment，<br>  w3cschool_title varchar（100）NOT NULL默认值’’，<br>  w3cschool_author<code>varchar（40）NOT NULL默认值&#39;&#39;，</code>submission_date<code>日期默认为NULL，
  主键（</code>w3cschool_id<code>），
  唯一键</code>AUTHOR_INDEX<code>（</code>w3cschool_author`）<br>）ENGINE = InnoDB<br>设置1行（0.00秒）<br>错误：<br>未指定查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">步骤二：</span><br><span class="line"></span><br><span class="line">修改SQL语句的数据表名，并执行SQL语句。</span><br></pre></td></tr></table></figure>
<p>mysql&gt;创建表<code>clone_tbl</code>（<br>  -&gt;<code>w3cschool_id</code> int（11）NOT NULL auto_increment，<br>  -&gt;<code>w3cschool_title</code> varchar（100）NOT NULL默认值’’，<br>  -&gt;<code>w3cschool_author</code> varchar（40）NOT NULL默认值’’，<br>  -&gt;<code>submission_date</code>日期默认为NULL，<br>  -&gt;主键（<code>w3cschool_id</code>），<br>  -&gt;唯一键<code>AUTHOR_INDEX</code>（<code>w3cschool_author</code>）<br>-&gt;）ENGINE = InnoDB;<br>查询正常，受影响的0行（1.80秒）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">步骤三：</span><br><span class="line"></span><br><span class="line">执行完第二步骤后，你将在数据库中创建新的克隆表clone_tbl。如果你想拷贝数据表的数据你可以使用**INSERT INTO ... SELECT**语句来实现。</span><br></pre></td></tr></table></figure>
<p>mysql&gt;插入到clone_tbl（w3cschool_id，<br>    -&gt; w3cschool_title，<br>    -&gt; w3cschool_author，<br>    -&gt;提交日期）<br>    -&gt;选择w3cschool_id，w3cschool_title，<br>    -&gt; w3cschool_author，提交日期<br>    -&gt;来自w3cschool_tbl;<br>查询正常，受影响的3行（0.07秒）<br>记录：3重复：0警告：0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">执行以上步骤后，您将完整的复制表，包括表结构及表数据。</span><br><span class="line">&lt;br&gt;</span><br><span class="line"></span><br><span class="line">### MySQL 元数据</span><br><span class="line"></span><br><span class="line">能想知道MySQL以下三种信息：</span><br><span class="line"></span><br><span class="line">**查询结果信息： SELECT, UPDATE 或 DELETE语句影响的记录数。</span><br><span class="line">数据库和数据表的信息： 包含了数据库及数据表的结构信息。</span><br><span class="line">MySQL服务器信息： 包含了数据库服务器的当前状态，版本号等。**</span><br><span class="line"></span><br><span class="line">在MySQL的命令提示符中，我们可以很容易的获取以上服务器信息。 但如果使用Perl或PHP等脚本语言，你就需要调用特定的接口函数来获取。</span><br><span class="line"></span><br><span class="line">#### 获取查询语句影响的记录数</span><br><span class="line">**PERL 实例**</span><br><span class="line"></span><br><span class="line">在 DBI 脚本中， 语句影响的记录数通过函数 do( ) 或 execute( )返回：</span><br></pre></td></tr></table></figure>
<h1 id="方法-1"><a href="#方法-1" class="headerlink" title="方法 1"></a>方法 1</h1><h1 id="使用do-执行-query"><a href="#使用do-执行-query" class="headerlink" title="使用do( ) 执行  $query"></a>使用do( ) 执行  $query</h1><p>my $count = $dbh-&gt;do ($query);</p>
<h1 id="如果发生错误会输出-0"><a href="#如果发生错误会输出-0" class="headerlink" title="如果发生错误会输出 0"></a>如果发生错误会输出 0</h1><p>printf “%d rows were affected\n”, (defined ($count) ? $count : 0);</p>
<h1 id="方法-2"><a href="#方法-2" class="headerlink" title="方法 2"></a>方法 2</h1><h1 id="使用prepare-及-execute-执行-query"><a href="#使用prepare-及-execute-执行-query" class="headerlink" title="使用prepare( ) 及 execute( ) 执行  $query"></a>使用prepare( ) 及 execute( ) 执行  $query</h1><p>my $sth = $dbh-&gt;prepare ($query);<br>my $count = $sth-&gt;execute ( );<br>printf “%d rows were affected\n”, (defined ($count) ? $count : 0);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">**PHP 实例**</span><br><span class="line"></span><br><span class="line">在PHP中，你可以使用 mysql_affected_rows( ) 函数来获取查询语句影响的记录数。</span><br></pre></td></tr></table></figure>
<p>$result_id = mysql_query ($query, $conn_id);</p>
<h1 id="如果查询失败返回"><a href="#如果查询失败返回" class="headerlink" title="如果查询失败返回"></a>如果查询失败返回</h1><p>$count = ($result_id ? mysql_affected_rows ($conn_id) : 0);<br>print (“$count rows were affected\n”);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 数据库和数据表列表</span><br><span class="line"></span><br><span class="line">你可以很容易的在MySQL服务器中获取数据库和数据表列表。 如果你没有足够的权限，结果将返回 null。</span><br><span class="line"></span><br><span class="line">你也可以使用 SHOW TABLES 或 SHOW DATABASES 语句来获取数据库和数据表列表。</span><br><span class="line"></span><br><span class="line">**PERL 实例**</span><br></pre></td></tr></table></figure>
<h1 id="获取当前数据库中所有可用的表。"><a href="#获取当前数据库中所有可用的表。" class="headerlink" title="获取当前数据库中所有可用的表。"></a>获取当前数据库中所有可用的表。</h1><p>my @tables = $dbh-&gt;tables ( );<br>foreach $table (@tables ){<br>   print “Table Name $table\n”;<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**PHP 实例**</span><br><span class="line">``````php</span><br><span class="line">&lt;?php</span><br><span class="line">$con = mysql_connect(&quot;localhost&quot;, &quot;userid&quot;, &quot;password&quot;);</span><br><span class="line">if (!$con)</span><br><span class="line">&#123;</span><br><span class="line">  die(&apos;Could not connect: &apos; . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$db_list = mysql_list_dbs($con);</span><br><span class="line"></span><br><span class="line">while ($db = mysql_fetch_object($db_list))</span><br><span class="line">&#123;</span><br><span class="line">  echo $db-&gt;Database . &quot;&lt;br /&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">mysql_close($con);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="获取服务器元数据"><a href="#获取服务器元数据" class="headerlink" title="获取服务器元数据"></a>获取服务器元数据</h4><p>以下命令语句可以在MySQL的命令提示符使用，也可以在脚本中 使用，如PHP脚本。</p>
<table>
<thead>
<tr>
<th align="right">命令</th>
<th align="right">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="right">SELECT VERSION( )</td>
<td align="right">服务器版本信息</td>
</tr>
<tr>
<td align="right">SELECT DATABASE( )</td>
<td align="right">当前数据库名 (或者返回空)</td>
</tr>
<tr>
<td align="right">SELECT USER( )</td>
<td align="right">当前用户名</td>
</tr>
<tr>
<td align="right">SHOW STATUS</td>
<td align="right">服务器状态</td>
</tr>
<tr>
<td align="right">SHOW VARIABLES</td>
<td align="right">服务器配置变量</td>
</tr>
</tbody></table>
<h3 id="MySQL序列使用"><a href="#MySQL序列使用" class="headerlink" title="MySQL序列使用"></a>MySQL序列使用</h3><p>MySQL序列是一个整体的整数：1、2、3，…，由于表数据表只能有一个分割自增主键，如果你想实现其他变量也实现自动增加，就可以使用MySQL序列来实现。</p>
<h4 id="使用AUTO-INCREMENT"><a href="#使用AUTO-INCREMENT" class="headerlink" title="使用AUTO_INCREMENT"></a>使用AUTO_INCREMENT</h4><p>MySQL中最简单的使用序列的方法就是使用MySQL AUTO_INCREMENT来定义列。</p>
<p>实例</p>
<p>以下实例中创建了数据表insect，昆虫中id无需指定值即可实现自动增长。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;创建表昆虫</span><br><span class="line">    -&gt;（</span><br><span class="line">    -&gt; id INT UNSIGNED NOT NULL AUTO_INCREMENT，</span><br><span class="line">    -&gt;主键（id），</span><br><span class="line">    -&gt;名称VARCHAR（30）NOT NULL，＃昆虫的类型</span><br><span class="line">    -&gt;日期DATE NOT NULL，收集了＃个日期</span><br><span class="line">    -&gt;原始VARCHAR（30）NOT NULL＃收集</span><br><span class="line">）;</span><br><span class="line">查询正常，受影响的0行（0.02秒）</span><br><span class="line">mysql&gt;插入昆虫（id，name，date，origin）值</span><br><span class="line">    -&gt;（NULL，&apos;housefly&apos;，&apos;2001-09-10&apos;，&apos;kitchen&apos;），</span><br><span class="line">    -&gt;（NULL，&apos;千足虫&apos;，&apos;2001-09-10&apos;，&apos;车道&apos;），</span><br><span class="line">    -&gt;（NULL，&apos;grasshopper&apos;，&apos;2001-09-10&apos;，&apos;front yard&apos;）;</span><br><span class="line">查询正常，受影响的3行（0.02秒）</span><br><span class="line">记录：3重复：0警告：0</span><br><span class="line">mysql&gt; SELECT * FROM insect ORDER BY id;</span><br><span class="line">+ ---- + -------------- + ------------ + ------------ +</span><br><span class="line">| id | 名称| 日期| 起源</span><br><span class="line">+ ---- + -------------- + ------------ + ------------ +</span><br><span class="line">| 1 | 家蝇| 2001-09-10 | 厨房|</span><br><span class="line">| 2 | 千足虫| 2001-09-10 | 车道</span><br><span class="line">| 3 | 蚱| 2001-09-10 | 前院|</span><br><span class="line">+ ---- + -------------- + ------------ + ------------ +</span><br><span class="line">设置3行（0.00秒）</span><br></pre></td></tr></table></figure>

<h4 id="获取AUTO-INCREMENT值"><a href="#获取AUTO-INCREMENT值" class="headerlink" title="获取AUTO_INCREMENT值"></a>获取AUTO_INCREMENT值</h4><p>在MySQL的客户端中你可以使用SQL中的LAST_INSERT_ID（）函数来获取最后的插入表中的自增列的值。</p>
<p>在PHP或PERL脚本中也提供了相应的函数来获取最后的插入表中的自增列的值。</p>
<p><strong>PERL实例</strong></p>
<p>使用mysql_insertid属性来获取AUTO_INCREMENT的值。实例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ dbh-&gt; do（“将昆虫插入（名称，日期，来源）</span><br><span class="line">VALUES（&apos;moth&apos;，&apos;2001-09-14&apos;，&apos;windowsill&apos;）“）;</span><br><span class="line">我的$ seq = $ dbh-&gt; &#123;mysql_insertid&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>PHP实例</strong></p>
<p>PHP通过mysql_insert_id（）函数来获取执行的插入SQL语句中AUTO_INCREMENT列的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql_query（“将昆虫插入（名称，日期，来源）</span><br><span class="line">VALUES（&apos;moth&apos;，&apos;2001-09-14&apos;，&apos;windowsill&apos;）“，$ conn_id）;</span><br><span class="line">$ seq = mysql_insert_id（$ conn_id）;</span><br></pre></td></tr></table></figure>


<h4 id="重置序列"><a href="#重置序列" class="headerlink" title="重置序列"></a>重置序列</h4><p>如果您删除了数据表中的多条记录，并希望对其余数据的AUTO_INCREMENT列进行重新转换，那么您可以通过删除自增的列，然后重新添加来实现。不过该操作要非常小心，如果在删除的同时又有新记录添加，有可能会出现数据混乱。操作如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE昆虫DROP id;</span><br><span class="line">mysql&gt; ALTER TABLE昆虫</span><br><span class="line">    -&gt;添加ID INT UNSIGNED NOT NULL AUTO_INCREMENT FIRST，</span><br><span class="line">    -&gt;添加主键（ID）;</span><br></pre></td></tr></table></figure>

<h4 id="设置序列的开始值"><a href="#设置序列的开始值" class="headerlink" title="设置序列的开始值"></a>设置序列的开始值</h4><p>一般情况下序列的开始数值1，但如果你需要指定一个开始值100，那我们可以通过以下语句来实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;创建表昆虫</span><br><span class="line">    -&gt;（</span><br><span class="line">    -&gt; id INT UNSIGNED NOT NULL AUTO_INCREMENT = 100，</span><br><span class="line">    -&gt;主键（id），</span><br><span class="line">    -&gt;名称VARCHAR（30）NOT NULL，＃昆虫的类型</span><br><span class="line">    -&gt;日期DATE NOT NULL，收集了＃个日期</span><br><span class="line">    -&gt;原始VARCHAR（30）NOT NULL＃收集</span><br><span class="line">）;</span><br></pre></td></tr></table></figure>
<p>或者您也可以在表创建成功后，通过以下语句来实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE t AUTO_INCREMENT = 100;</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-及-SQL-注入"><a href="#MySQL-及-SQL-注入" class="headerlink" title="MySQL 及 SQL 注入"></a>MySQL 及 SQL 注入</h3><p>如果您通过网页获取用户输入的数据并将其插入一个MySQL数据库，那么就有可能发生SQL注入安全的问题。</p>
<p>本章节将为大家介绍如何防止SQL注入，并通过脚本来过滤SQL中注入的字符。</p>
<p>所谓SQL注入，就是通过把SQL命令插入到Web表单递交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的SQL命令。</p>
<p>我们永远不要信任用户的输入，我们必须认定用户输入的数据都是不安全的，我们都需要对用户输入的数据进行过滤处理。</p>
<p>以下实例中，输入的用户名必须为字母、数字及下划线的组合，且用户名长度为 8 到 20 个字符之间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&quot;/^\w&#123;8,20&#125;$/&quot;, $_GET[&apos;username&apos;], $matches))</span><br><span class="line">&#123;</span><br><span class="line">   $result = mysql_query(&quot;SELECT * FROM users </span><br><span class="line">                          WHERE username=$matches[0]&quot;);</span><br><span class="line">&#125;</span><br><span class="line"> else </span><br><span class="line">&#123;</span><br><span class="line">   echo &quot;username 输入异常&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>让我们看下在没有过滤特殊字符时，出现的SQL情况：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 设定$name 中插入了我们不需要的SQL语句</span><br><span class="line">$name = &quot;Qadir&apos;; DELETE FROM users;&quot;;</span><br><span class="line">mysql_query(&quot;SELECT * FROM users WHERE name=&apos;&#123;$name&#125;&apos;&quot;);</span><br></pre></td></tr></table></figure>
<p>以上的注入语句中，我们没有对 $name 的变量进行过滤，$name 中插入了我们不需要的SQL语句，将删除 users 表中的所有数据。</p>
<p>在PHP中的 mysql_query() 是不允许执行多个SQL语句的，但是在 SQLite 和 PostgreSQL 是可以同时执行多条SQL语句的，所以我们对这些用户的数据需要进行严格的验证。</p>
<p>防止SQL注入，我们需要注意以下几个要点：</p>
<p><strong>1.永远不要信任用户的输入。对用户的输入进行校验，可以通过正则表达式，或限制长度；对单引号和 双”-“进行转换等。<br>2.永远不要使用动态拼装sql，可以使用参数化的sql或者直接使用存储过程进行数据查询存取。<br>3.永远不要使用管理员权限的数据库连接，为每个应用使用单独的权限有限的数据库连接。<br>4.不要把机密信息直接存放，加密或者hash掉密码和敏感的信息。<br>5.应用的异常信息应该给出尽可能少的提示，最好使用自定义的错误信息对原始错误信息进行包装<br>6.sql注入的检测方法一般采取辅助软件或网站平台来检测，软件一般采用sql注入检测工具jsky，网站平台就有亿思网站安全平台检测工具。MDCSOFT SCAN等。采用MDCSOFT-IPS可以有效的防御SQL注入，XSS攻击等。</strong></p>
<h4 id="防止SQL注入"><a href="#防止SQL注入" class="headerlink" title="防止SQL注入"></a>防止SQL注入</h4><p>在脚本语言，如Perl和PHP你可以对用户输入的数据进行转义从而来防止SQL注入。</p>
<p>PHP的MySQL扩展提供了mysql_real_escape_string()函数来转义特殊的输入字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if (get_magic_quotes_gpc()) </span><br><span class="line">&#123;</span><br><span class="line">  $name = stripslashes($name);</span><br><span class="line">&#125;</span><br><span class="line">$name = mysql_real_escape_string($name);</span><br><span class="line">mysql_query(&quot;SELECT * FROM users WHERE name=&apos;&#123;$name&#125;&apos;&quot;);</span><br></pre></td></tr></table></figure>

<p>Like语句中的注入<br>like查询时，如果用户输入的值有”<em>“和”%”，则会出现这种情况：用户本来只是想查询”abcd</em>“，查询结果中却有”abcd_”、”abcde”、”abcdf”等等；用户要查询”30%”（注：百分之三十）时也会出现问题。</p>
<p>在PHP脚本中我们可以使用addcslashes()函数来处理以上情况，如下实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sub = addcslashes(mysql_real_escape_string(&quot;%something_&quot;), &quot;%_&quot;);</span><br><span class="line">// $sub == \%something\_</span><br><span class="line">mysql_query(&quot;SELECT * FROM messages WHERE subject LIKE &apos;&#123;$sub&#125;%&apos;&quot;);</span><br></pre></td></tr></table></figure>
<p>addcslashes() 函数在指定的字符前添加反斜杠。</p>
<p>语法格式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addcslashes(string,characters)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="right">参数</th>
<th align="right">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="right">string</td>
<td align="right">必需。规定要检查的字符串。</td>
</tr>
<tr>
<td align="right">characters</td>
<td align="right">可选。规定受 addcslashes() 影响的字符或字符范围。</td>
</tr>
</tbody></table>
<h3 id="MySQL-导出数据"><a href="#MySQL-导出数据" class="headerlink" title="MySQL 导出数据"></a>MySQL 导出数据</h3><p>MySQL中你可以使用SELECT…INTO OUTFILE语句来简单的导出数据到文本文件上。</p>
<p>使用 <strong>SELECT … INTO OUTFILE</strong> 语句导出数据</p>
<p>以下实例中我们将数据表 w3cschool_tbl 数据导出到 /tmp/tutorials.txt 文件中:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM tutorials_tbl </span><br><span class="line">    -&gt; INTO OUTFILE &apos;/tmp/tutorials.txt&apos;;</span><br></pre></td></tr></table></figure>

<p>你可以通过命令选项来设置数据输出的指定格式，以下实例为导出 CSV 格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM passwd INTO OUTFILE &apos;/tmp/tutorials.txt&apos;</span><br><span class="line">    -&gt; FIELDS TERMINATED BY &apos;,&apos; ENCLOSED BY &apos;&quot;&apos;</span><br><span class="line">    -&gt; LINES TERMINATED BY &apos;\r\n&apos;;</span><br></pre></td></tr></table></figure>

<p>在下面的例子中，生成一个文件，各值用逗号隔开。这种格式可以被许多程序使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT a,b,a+b INTO OUTFILE &apos;/tmp/result.text&apos;</span><br><span class="line">FIELDS TERMINATED BY &apos;,&apos; OPTIONALLY ENCLOSED BY &apos;&quot;&apos;</span><br><span class="line">LINES TERMINATED BY &apos;\n&apos;</span><br><span class="line">FROM test_table;</span><br></pre></td></tr></table></figure>

<h4 id="SELECT-…-INTO-OUTFILE-语句有以下属性"><a href="#SELECT-…-INTO-OUTFILE-语句有以下属性" class="headerlink" title="SELECT … INTO OUTFILE 语句有以下属性:"></a>SELECT … INTO OUTFILE 语句有以下属性:</h4><ul>
<li>LOAD DATA INFILE是SELECT … INTO OUTFILE的逆操作，SELECT句法。为了将一个数据库的数据写入一个文件，使用SELECT … INTO OUTFILE，为了将文件读回数据库，使用LOAD DATA INFILE。</li>
<li>SELECT…INTO OUTFILE ‘file_name’形式的SELECT可以把被选择的行写入一个文件中。该文件被创建到服务器主机上，因此您必须拥有FILE权限，才能使用此语法。</li>
<li>输出不能是一个已存在的文件。防止文件数据被篡改。</li>
<li>你需要有一个登陆服务器的账号来检索文件。否则 SELECT … INTO OUTFILE 不会起任何作用。</li>
<li>在UNIX中，该文件被创建后是可读的，权限由MySQL服务器所拥有。这意味着，虽然你就可以读取该文件，但可能无法将其删除。</li>
</ul>
<h4 id="导出表作为原始数据"><a href="#导出表作为原始数据" class="headerlink" title="导出表作为原始数据"></a>导出表作为原始数据</h4><p>mysqldump是MySQL用于转存储数据库的实用程序。它主要产生一个SQL脚本，其中包含从头重新创建数据库所必需的命令CREATE TABLE INSERT等。</p>
<p>使用mysqldump导出数据需要使用 –tab 选项来指定导出文件指定的目录，该目标必须是可写的。<br>以下实例将数据表 tutorials_tbl 导出到 /tmp 目录中：</p>
<p>$ mysqldump -u root -p –no-create-info <br>            –tab=/tmp W3CSCHOOL w3cschool_tbl<br>password <strong>**</strong><br>导出SQL格式的数据<br>导出SQL格式的数据到指定文件，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysqldump -u root -p W3CSCHOOL w3cschool_tbl &gt; dump.txt</span><br><span class="line">password ******</span><br></pre></td></tr></table></figure>

<p>以上命令创建的文件内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">-- MySQL dump 8.23</span><br><span class="line">--</span><br><span class="line">-- Host: localhost    Database: W3CSCHOOL</span><br><span class="line">---------------------------------------------------------</span><br><span class="line">-- Server version       3.23.58</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Table structure for table `w3cschool_tbl`</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">CREATE TABLE w3cschool_tbl (</span><br><span class="line">  w3cschool_id int(11) NOT NULL auto_increment,</span><br><span class="line">  w3cschool_title varchar(100) NOT NULL default &apos;&apos;,</span><br><span class="line">  w3cschool_author varchar(40) NOT NULL default &apos;&apos;,</span><br><span class="line">  submission_date date default NULL,</span><br><span class="line">  PRIMARY KEY  (w3cschool_id),</span><br><span class="line">  UNIQUE KEY AUTHOR_INDEX (w3cschool_author)</span><br><span class="line">) TYPE=MyISAM;</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">-- Dumping data for table `w3cschool_tbl`</span><br><span class="line">--</span><br><span class="line"></span><br><span class="line">INSERT INTO w3cschool_tbl </span><br><span class="line">       VALUES (1,&apos;Learn PHP&apos;,&apos;John Poul&apos;,&apos;2007-05-24&apos;);</span><br><span class="line">INSERT INTO w3cschool_tbl </span><br><span class="line">       VALUES (2,&apos;Learn MySQL&apos;,&apos;Abdul S&apos;,&apos;2007-05-24&apos;);</span><br><span class="line">INSERT INTO w3cschool_tbl </span><br><span class="line">       VALUES (3,&apos;JAVA Tutorial&apos;,&apos;Sanjay&apos;,&apos;2007-05-06&apos;);</span><br></pre></td></tr></table></figure>

<p>如果你需要导出整个数据库的数据，可以使用以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysqldump -u root -p W3CSCHOOL &gt; database_dump.txt</span><br><span class="line">password ******</span><br></pre></td></tr></table></figure>
<p>如果需要备份所有数据库，可以使用以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysqldump -u root -p --all-databases &gt; database_dump.txt</span><br><span class="line">password ******</span><br></pre></td></tr></table></figure>

<p>–all-databases 选项在 MySQL 3.23.12 及以后版本加入。</p>
<p>该方法可用于实现数据库的备份策略。</p>
<h4 id="将数据表及数据库拷贝至其他主机"><a href="#将数据表及数据库拷贝至其他主机" class="headerlink" title="将数据表及数据库拷贝至其他主机"></a>将数据表及数据库拷贝至其他主机</h4><p>如果你需要将数据拷贝至其他的 MySQL 服务器上, 你可以在 mysqldump 命令中指定数据库名及数据表。</p>
<p>在源主机上执行以下命令，将数据备份至 dump.txt 文件中:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysqldump -u root -p database_name table_name &gt; dump.txt</span><br><span class="line">password *****</span><br></pre></td></tr></table></figure>

<p>如果完整备份数据库，则无需使用特定的表名称。</p>
<p>如果你需要将备份的数据库导入到MySQL服务器中，可以使用以下命令，使用以下命令你需要确认数据库已经创建：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p database_name &lt; dump.txt password *****</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">你也可以使用以下命令将导出的数据直接导入到远程的服务器上，但请确保两台服务器是相通的，是可以相互访问的：&lt;/p&gt;</span><br><span class="line">$ mysqldump -u root -p database_name \</span><br><span class="line">       | mysql -h other-host.com database_name</span><br></pre></td></tr></table></figure>
<p>以上命令中使用了管道来将导出的数据导入到指定的远程主机上。</p>
<h3 id="MySQL-导入数据"><a href="#MySQL-导入数据" class="headerlink" title="MySQL 导入数据"></a>MySQL 导入数据</h3><p>MySQL中可以使用两种简单的方式来导入MySQL导出的数据。</p>
<p><strong>使用 LOAD DATA 导入数据</strong><br>MySQL 中提供了LOAD DATA INFILE语句来插入数据。 以下实例中将从当前目录中读取文件 dump.txt ，将该文件中的数据插入到当前数据库的 mytbl 表中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; LOAD DATA LOCAL INFILE &apos;dump.txt&apos; INTO TABLE mytbl;</span><br></pre></td></tr></table></figure>
<p>如果指定LOCAL关键词，则表明从客户主机上按路径读取文件。如果没有指定，则文件在服务器上按路径读取文件。</p>
<p>你能明确地在LOAD DATA语句中指出列值的分隔符和行尾标记，但是默认标记是定位符和换行符。</p>
<p>两个命令的 FIELDS 和 LINES 子句的语法是一样的。两个子句都是可选的，但是如果两个同时被指定，FIELDS 子句必须出现在 LINES 子句之前。</p>
<p>如果用户指定一个 FIELDS 子句，它的子句 （TERMINATED BY、[OPTIONALLY] ENCLOSED BY 和 ESCAPED BY) 也是可选的，不过，用户必须至少指定它们中的一个。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; LOAD DATA LOCAL INFILE &apos;dump.txt&apos; INTO TABLE mytbl</span><br><span class="line">  -&gt; FIELDS TERMINATED BY &apos;:&apos;</span><br><span class="line">  -&gt; LINES TERMINATED BY &apos;\r\n&apos;;</span><br></pre></td></tr></table></figure>

<p>LOAD DATA 默认情况下是按照数据文件中列的顺序插入数据的，如果数据文件中的列与插入表中的列不一致，则需要指定列的顺序。</p>
<p>如，在数据文件中的列顺序是 a,b,c，但在插入表的列顺序为b,c,a，则数据导入语法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; LOAD DATA LOCAL INFILE &apos;dump.txt&apos; </span><br><span class="line">    -&gt; INTO TABLE mytbl (b, c, a);</span><br></pre></td></tr></table></figure>

<p>使用 mysqlimport 导入数据<br>mysqlimport客户端提供了LOAD DATA INFILEQL语句的一个命令行接口。mysqlimport的大多数选项直接对应LOAD DATA INFILE子句。</p>
<p>从文件 dump.txt 中将数据导入到 mytbl 数据表中, 可以使用以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysqlimport -u root -p --local database_name dump.txt</span><br><span class="line">password *****</span><br></pre></td></tr></table></figure>
<p>mysqlimport命令可以指定选项来设置指定格式,命令语句格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mysqlimport -u root -p --local --fields-terminated-by=&quot;:&quot; \</span><br><span class="line">   --lines-terminated-by=&quot;\r\n&quot;  database_name dump.txt</span><br><span class="line">password *****</span><br></pre></td></tr></table></figure>

<p>mysqlimport 语句中使用 –columns 选项来设置列的顺序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mysqlimport -u root -p --local --columns=b,c,a \</span><br><span class="line">    database_name dump.txt</span><br><span class="line">password *****</span><br></pre></td></tr></table></figure>


<p><strong>mysqlimport的常用选项介绍</strong><br>选项|    功能<br>–:|–:|<br>-d or –delete    |新数据导入数据表中之前删除数据数据表中的所有信息<br>-f or –force    |不管是否遇到错误，mysqlimport将强制继续插入数据<br>-i or –ignore    |mysqlimport跳过或者忽略那些有相同唯一 关键字的行， 导入文件中的数据将被忽略。<br>-l or -lock-tables    |数据被插入之前锁住表，这样就防止了， 你在更新数据库时，用户的查询和更新受到影响。<br>-r or -replace    |这个选项与－i选项的作用相反；此选项将替代 表中有相同唯一关键字的记录。<br>–fields-enclosed- by= char|    指定文本文件中数据的记录时以什么括起的， 很多情况下 数据以双引号括起。 默认的情况下数据是没有被字符括起的。<br>–fields-terminated- by=char    |指定各个数据的值之间的分隔符，在句号分隔的文件中， 分隔符是句号。您可以用此选项指定数据之间的分隔符。 默认的分隔符是跳格符（Tab）<br>–lines-terminated- by=str    |此选项指定文本文件中行与行之间数据的分隔字符串 或者字符。 默认的情况下mysqlimport以newline为行分隔符。 您可以选择用一个字符串来替代一个单个的字符： 一个新行或者一个回车。</p>
<p>mysqlimport命令常用的选项还有-v 显示版本（version）， -p 提示输入密码（password）等。</p>

    </article>
    <!-- license  -->
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2019/12/21/YSQL-%E5%87%BD%E6%95%B0%EF%BC%88%E4%B8%89%EF%BC%89/" title= "MYSQL 函数（三）">
                    <div class="nextTitle">MYSQL 函数（三）</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2019/12/21/ysql-%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86-%E4%B8%80/" title= "Mysql 基础部分(一)">
                    <div class="prevTitle">Mysql 基础部分(一)</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!-- partial('_partial/comment/changyan') -->
    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:1473338449@qq.com" target="_blank" rel="noopener" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/wuhjg0" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
            
                <span class="iconfont-archer wechat" title=wechat>
                  
                  <img class="profile-qr" src="/assets/example_qr.png" />
                </span>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MYSQL基础部分（二）"><span class="toc-number">1.</span> <span class="toc-text">MYSQL基础部分（二）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-where-子句"><span class="toc-number">1.1.</span> <span class="toc-text">MySQL where 子句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#从命令提示符中读取数据"><span class="toc-number">1.1.1.</span> <span class="toc-text">从命令提示符中读取数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-UPDATE-查询"><span class="toc-number">1.2.</span> <span class="toc-text">MySQL UPDATE 查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-DELETE-语句"><span class="toc-number">1.3.</span> <span class="toc-text">MySQL DELETE 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-LIKE-子句"><span class="toc-number">1.4.</span> <span class="toc-text">MySQL LIKE 子句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-排序"><span class="toc-number">1.5.</span> <span class="toc-text">MySQL 排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-分组"><span class="toc-number">1.6.</span> <span class="toc-text">MySQL 分组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL-GROUP-BY-语句"><span class="toc-number">1.6.1.</span> <span class="toc-text">MySQL GROUP BY 语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-NULL值处理"><span class="toc-number">1.7.</span> <span class="toc-text">MySQL NULL值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-ALTER命令"><span class="toc-number">1.8.</span> <span class="toc-text">MySQL ALTER命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-索引"><span class="toc-number">1.9.</span> <span class="toc-text">MySQL 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#普通索引"><span class="toc-number">1.9.1.</span> <span class="toc-text">普通索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#唯一索引"><span class="toc-number">1.9.2.</span> <span class="toc-text">唯一索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用ALTER-命令添加和删除索引"><span class="toc-number">1.9.3.</span> <span class="toc-text">使用ALTER 命令添加和删除索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#显示索引信息"><span class="toc-number">1.9.4.</span> <span class="toc-text">显示索引信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL临时表"><span class="toc-number">1.10.</span> <span class="toc-text">MySQL临时表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#删除MySQL临时表"><span class="toc-number">1.10.1.</span> <span class="toc-text">删除MySQL临时表</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#方法-1"><span class="toc-number"></span> <span class="toc-text">方法 1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用do-执行-query"><span class="toc-number"></span> <span class="toc-text">使用do( ) 执行  $query</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如果发生错误会输出-0"><span class="toc-number"></span> <span class="toc-text">如果发生错误会输出 0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#方法-2"><span class="toc-number"></span> <span class="toc-text">方法 2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用prepare-及-execute-执行-query"><span class="toc-number"></span> <span class="toc-text">使用prepare( ) 及 execute( ) 执行  $query</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#如果查询失败返回"><span class="toc-number"></span> <span class="toc-text">如果查询失败返回</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#获取当前数据库中所有可用的表。"><span class="toc-number"></span> <span class="toc-text">获取当前数据库中所有可用的表。</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#获取服务器元数据"><span class="toc-number">0.0.1.</span> <span class="toc-text">获取服务器元数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL序列使用"><span class="toc-number">0.1.</span> <span class="toc-text">MySQL序列使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用AUTO-INCREMENT"><span class="toc-number">0.1.1.</span> <span class="toc-text">使用AUTO_INCREMENT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取AUTO-INCREMENT值"><span class="toc-number">0.1.2.</span> <span class="toc-text">获取AUTO_INCREMENT值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#重置序列"><span class="toc-number">0.1.3.</span> <span class="toc-text">重置序列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#设置序列的开始值"><span class="toc-number">0.1.4.</span> <span class="toc-text">设置序列的开始值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-及-SQL-注入"><span class="toc-number">0.2.</span> <span class="toc-text">MySQL 及 SQL 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#防止SQL注入"><span class="toc-number">0.2.1.</span> <span class="toc-text">防止SQL注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-导出数据"><span class="toc-number">0.3.</span> <span class="toc-text">MySQL 导出数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SELECT-…-INTO-OUTFILE-语句有以下属性"><span class="toc-number">0.3.1.</span> <span class="toc-text">SELECT … INTO OUTFILE 语句有以下属性:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#导出表作为原始数据"><span class="toc-number">0.3.2.</span> <span class="toc-text">导出表作为原始数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#将数据表及数据库拷贝至其他主机"><span class="toc-number">0.3.3.</span> <span class="toc-text">将数据表及数据库拷贝至其他主机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-导入数据"><span class="toc-number">0.4.</span> <span class="toc-text">MySQL 导入数据</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 14
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/HP-%E8%AF%AD%E5%8F%A5/" >PHP 语句</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/HP%E5%87%BD%E6%95%B0/" >PHP函数</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/HP%E6%95%B0%E7%BB%84/" >PHP数组</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/PHP-%E8%B6%85%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F/" >PHP 超全局变量  </a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/ntitled/" >PHP常量---运算符</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/HP-%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD/" >PHP 文件加载</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/HP-%E8%A1%A8%E5%8D%95/" >PHP 表单 </a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/HP%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" >PHP文件操作</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/ysql-%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86-%E4%B8%80/" >Mysql 基础部分(一)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/Mysql%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86%EF%BC%88%E4%BA%8C%EF%BC%89/" >Mysql基础部分（二）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2019/12/21/YSQL-%E5%87%BD%E6%95%B0%EF%BC%88%E4%B8%89%EF%BC%89/" >MYSQL 函数（三）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/20</span><a class="archive-post-title" href= "/2019/11/20/PHP%E5%8F%98%E9%87%8F/" >PHP变量</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/20</span><a class="archive-post-title" href= "/2019/11/20/PHP-1/" >PHP基本语法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/15</span><a class="archive-post-title" href= "/2019/11/15/hello-world/" >Hello World</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "John Doe"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


